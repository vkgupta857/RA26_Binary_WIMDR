{% extends 'base.html' %}
{% block head%}
  <script type="text/javascript">

var countries = Object();

countries['Madhya Pradesh'] = 'Agar Malwa| Alirajpur| Anuppur | Ashok Nagar| Balaghat| Barwani|Betul|Bhind| Bhopal| Burhanpur|Chachaura-Binaganj|Chhatarpur|Chhindwara|Damoh|Datia|Dewas|Dhar|Dindori|Guna|Gwalior|Harda|Hoshangabad|Indore|Jabalpur|Jhabua|Katni|Khandwa|Khargone|Maihar|Mandla|Mandsaur|Morena|Narsinghpur|Nagda|Neemuch|Niwari|Panna|Raisen|Rajgarh|Ratlam|Rewa|Sagar|Satna|Sehore|Seon|Shahdol|Shajapur|Sheopur|Shivpuri|Sidhi|Singrauli|Tikamgarh|Ujjain|Umaria|Vidisha';

countries['Rajasthan'] = 'Ajmer|Alwar|Bikaner|Barmer|Banswara|Bharatpur|Baran|Bundi|Bhilwara|Churu| Chittorgarh|Dausa|Dholpur|Dungarpur|Ganganagar|Hanumangarh|Jhunjhunu|Jalore| Jodhpur|Jaipur|Jaisalmer|Jhalawar|Karauli|Kota|Nagaur|Pali|Pratapgarh|Rajsamand|Sikar|Sawai Madhopur|Sirohi|Tonk|Udaipur';

countries['Maharashtra'] = 'Ahmednagar|Akola|Amravati|Aurangabad|Beed|Bhandara|Buldhana|Chandrapur|Dhule| Gadchiroli|Gondia|Hingoli|Jalgaon|Jalna|Kolhapur|Latur|Mumbai City|Mumbai suburban|Nanded|Nandurbar| Nagpur|Nashik|Osmanabad|Palghar|Parbhani|Pune|Raigad|Ratnagiri|Sangli|Satara|Sindhudurg| Solapur|Thane|Wardha|Washim|Yavatmal';

countries['Gujarat'] = 'Ahmedabad|Amreli|Anand|Aravalli|Banaskantha|Bharuch|Bhavnagar|Botad|Chhota Udepur|Dahod|Dang|Devbhoomi Dwarka|Gandhinagar|Gir Somnath|Jamnagar|Junagadh|Kheda|Kutch|Mahisagar |Mehsana|Morbi|Narmada|Navsari|Panchmahal|Patan|Porbandar|Rajkot|Sabarkantha|Surat|Surendranagar|Tapi| Vadodara|Valsad';

countries['Uttar Pradesh'] = 'Agra|Aligarh|Prayagraj|Ambedkar Nagar|Amethi|Amroha|Auraiya|Azamgarh|Bagpat|Bahraich|Ballia|Balrampur|Banda|Barabanki|Bareilly|Basti|Bhadohi|Bijnor|Budaun|Bulandshahr|Chandauli|Chitrakoot|Deoria|Etah|Etawah|Ayodhya|Farrukhabad|Fatehpur|Firozabad|Gautam Buddh Nagar|Ghaziabad|Ghazipur|Gonda|Gorakhpur|Hamirpur|Hapur|Hardoi|Hathras|Jalaun|Jaunpur|Jhansi|Kannauj|Kanpur Dehat|Kanpur Nagar|Kasganj|Kaushambi|Kushinagar|Lakhimpur Kheri|Lalitpur|Lucknow|Maharajganj| Mahoba|Mainpuri|Mathura|Mau|Meerut|Mirzapur|Moradabad|Muzaffarnagar|Pilibhit|Pratapgarh|Raebareli|Rampur|Saharanpur|Sambhal| Sant Kabir Nagar|Shahjahanpur|Shamli|Shravasti|Siddharthnagar|Sitapur|Sonbhadra|Sultanpur|Unnao|Varanasi';


function setRegions()
{
  for (region in countries)
    document.write('<option value="' + region + '">' + region + '</option>');
}

function set_country(oRegionSel, oCountrySel)
{
  var countryArr;
  oCountrySel.length = 0;
  var region = oRegionSel.options[oRegionSel.selectedIndex].text;
  if (countries[region])
  {
    oCountrySel.disabled = false;
    oCountrySel.options[0] = new Option('Select city','');
    countryArr = countries[region].split('|');
    for (var i = 0; i < countryArr.length; i++)
      oCountrySel.options[i + 1] = new Option(countryArr[i], countryArr[i]);
  }
  else oCountrySel.disabled = true;
}

function enable(dd,custom,end){
    if (dd.value == "date")
   {
     custom.disabled=false;
     end.disabled=false;
   }
}



</script>
  <style>
    select{
    padding: 10px;
    width: 190px;
    background-color: rgb(240,240,240);

  }

table {
  margin: 0 auto;
  width: 82%;
  text-align: center;
  border-collapse: collapse;
  border: 1px solid #d4d4d4;
  font-size: 14px;
  background: #fff;
}

table th, 
table tr:nth-child(2n+2) {
  background: rgb(250,250,250);
}
 
table th, 
table td {
  padding: 20px 50px;
}
 
table th {
  border-bottom: 1px solid #d4d4d4;
}
  .chart-container {
        max-height: 400px;
        overflow: auto;
    }

  </style>
{% endblock %}
{% block body %}
    <!-- Navigation -->
      <!-- Navigation -->
    <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-light top-nav fixed-top" style="box-shadow: 10px 10px 5px grey;">
        <div class="container">
            <a class="navbar-brand" href="/index">
            <img src="{{ url_for('static', filename='images/logo.png')}}" alt="logo" /><a style="color: #4e3914;"><h3>Waste Management</h3></a>
            </a>
            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
				<span class="fas fa-bars"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
               <ul class="navbar-nav ml-auto">
                  <li class="nav-item">
                     <a class="nav-link" href="/index">Home</a>
                  </li>
                  <li class="nav-item">
                     <a class="nav-link" href="/login">Login</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" href="/upload">
                     Upload
                     </a>
                  </li>
                   <li class="nav-item">
                      <a class="nav-link active" href="/graphs">
                     Reports
                     </a>
                  </li>
               </ul>
            </div>
        </div>
    </nav>
    <br>
	<table>
<form ><tr><td>
STATE&raquo; <select class="btn btn-default dropdown-toggle" onchange="set_country(this,country)" size="1" name="state">
<option value="" selected="selected">Select state</option>
<script type="text/javascript">
setRegions(this);
</script>
</select></td><td>
CITY&raquo; <select class="btn btn-default dropdown-toggle" name="city" size="1" disabled="disabled" onchange=""></select></td><td><button class="btn btn-success " style="opacity: 0.9;" onclick="">Load Graph</button></td></tr><tr>
<td>DURATION&raquo; <select class="btn btn-default dropdown-toggle" name="duration" size="1" onchange="enable(this,custom,end)">


<option value="week">Last Week</option>
<option value="month">Last Month</option>
<option value="3 month">Last 3 Months</option>
<option value="year">Last Year</option>
<option value="date">Add custom</option>
</select></td><td>
START DATE&raquo; 

<input name="start date" type="date" id="custom" value="start" disabled="disabled"/></td><td>

END DATE&raquo; 
<input name="end date" type="date" id="end" value="end"  disabled="disabled"/></td></tr>


</form>
</table>

<div class="container">
    <div class="row">
        <div class="col-md-6">
            <div class="card">
                <div class="card-body">
                    <div id="category-chart-container" class="chart-container"></div>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card">
                <div class="card-body">
                    <div id="resolve-chart-container" class="chart-container"></div>
                </div>
            </div>
        </div>
    </div>
</div>
<br>
 <script type="text/javascript" src="https://cdn.fusioncharts.com/fusioncharts/latest/fusioncharts.js"></script>
<!-- Step 2 - Include the fusion theme -->
<script type="text/javascript"
    src="https://cdn.fusioncharts.com/fusioncharts/latest/themes/fusioncharts.theme.fusion.js"></script>

<script type="text/javascript">

    const categoryDataSource = {
        chart: {
            caption: "Queries reported category-wise",
            plottooltext: "<b>$percentValue</b> of $label reported",
            showlegend: "1",
            showpercentvalues: "1",
            legendposition: "bottom",
            usedataplotcolorforlabels: "1",
            theme: "fusion"
        },
        data: [
            {
                label: "High Waste",
                value: "{{params['p_h']}}"
            },
            {
                label: "Medium Waste",
                value: "{{params['p_m']}}"
            },
            {
                label: "Low Waste",
                value: "{{params['p_l']}}"
            }
        ]
    };

    const resolveDataSource = {
        chart: {
            caption: "Queries resolved within time vs late",
            plottooltext: "<b>$percentValue</b> of $label ",
            showlegend: "1",
            showpercentvalues: "1",
            legendposition: "bottom",
            usedataplotcolorforlabels: "1",
            theme: "fusion"
        },
 data: [
            {
                label: "Resolved in time",
                value: "{{params['p_resolve_on_time']}}"
            },
            {
                label: "Resolved late",
                value: "{{params['p_resolve_late']}}"
            }
       
        ]
    };
   

    FusionCharts.ready(function () {
  

        var categoryChart = new FusionCharts({
            type: "pie3d",
            renderAt: "category-chart-container",
            width: "100%",
            height: "500%",
            dataFormat: "json",
            dataSource: categoryDataSource
        }).render();

        var resolveChart = new FusionCharts({
            type: "pie3d",
            renderAt: "resolve-chart-container",
            width: "100%",
            height: "500%",
            dataFormat: "json",
            dataSource: resolveDataSource
        }).render();

    
    });

</script>
<!-- Bootstrap core JavaScript -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script> 
<script src="//geodata.solutions/includes/statecity.js"></script>
{% endblock %}
